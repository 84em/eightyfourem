!function(e,t,o,i,n,r){const{registerBlockType:l}=e,{createElement:a,Component:s}=t,{InspectorControls:g,FontSizePicker:u,PanelColorSettings:c}=o,{PanelBody:d,ToggleControl:v,SelectControl:m,ColorPicker:w,RangeControl:S,TextControl:h}=i,{__:p}=n,{useSelect:C}=r;class z extends s{constructor(e){super(e),this.state={reviews:null,loading:!0,error:null}}formatReviewTime(e){const t=new Date(1e3*e),o=new Date,i=Math.floor((o-t)/864e5);return i<7?0===i?"Today":1===i?"Yesterday":i+" days ago":t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}componentDidMount(){const{attributes:e}=this.props,{reviewsSort:t}=e;this.fetchReviews(t)}componentDidUpdate(e){const{attributes:t}=this.props,{reviewsSort:o}=t;e.attributes.reviewsSort!==o&&(this.setState({loading:!0}),this.fetchReviews(o))}fetchReviews(e=null){const t=new FormData;t.append("action","get_google_reviews"),t.append("nonce",googleReviewsAjax.nonce),e&&t.append("sort_by",e),fetch(googleReviewsAjax.ajax_url,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?this.setState({reviews:e.data,loading:!1}):this.setState({error:e.data||"Failed to load reviews",loading:!1})}).catch(e=>{this.setState({error:"Network error",loading:!1})})}renderStars(e,t,o){const i=[],n=t||"#ffc107",r="#ddd";for(let t=1;t<=5;t++){let l="star empty",s={color:r,...o&&{fontSize:o}};t<=e?(l="star filled",s={color:n,...o&&{fontSize:o}}):t-.5<=e&&(l="star half",s={background:`linear-gradient(90deg, ${n} 50%, ${r} 50%)`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",...o&&{fontSize:o}}),i.push(a("span",{key:t,className:l,style:s},"★"))}return i}render(){const{attributes:e,setAttributes:t}=this.props,{showLink:o,showReviewContent:i,maxReviews:n,alignment:r,backgroundColor:l,textColor:s,reviewsSort:w,overrideUrl:C,overrideTitle:z,customRatingText:T,showTitle:x,showRatingText:b,ratingTextBelow:f,titleFontSize:y,titleFontSizeCustom:k,ratingTextFontSize:F,ratingTextFontSizeCustom:R,reviewsFontSize:_,reviewsFontSizeCustom:B,reviewTimeFontSize:N,reviewTimeFontSizeCustom:L,starsFontSize:D,starsFontSizeCustom:M,titleTextColor:E,titleBackgroundColor:O,ratingTextColor:H,ratingBackgroundColor:U,reviewsTextColor:A,reviewsBackgroundColor:G,reviewTimeTextColor:I,reviewTimeBackgroundColor:P,starsTextColor:$,starsBackgroundColor:j}=e,{reviews:W,loading:q,error:Y}=this.state,X=wp.data.select("core/editor")&&wp.data.select("core/editor").getEditorSettings().fontSizes||wp.data.select("core/block-editor")&&wp.data.select("core/block-editor").getSettings().fontSizes||[{name:p("Small"),size:"0.9rem",slug:"small"},{name:p("Medium"),size:"1.05rem",slug:"medium"},{name:p("Large"),size:"1.85rem",slug:"large"},{name:p("Extra Large"),size:"2.5rem",slug:"x-large"},{name:p("Extra Extra Large"),size:"3.27rem",slug:"xx-large"}],J=(e,t)=>{if(t)return{fontSize:t+"px"};if(e){const t=X.find(t=>t.slug===e);return t?{fontSize:t.size}:{}}return{}},K=e=>e?"has-"+e+"-font-size":"",Q={...J(y,k),...E&&{color:E},...O&&{backgroundColor:O}},V=K(y),Z={...J(F,R),...H&&{color:H}},ee=K(F),te={...U&&{backgroundColor:U}},oe={...J(_,B),...A&&{color:A},...G&&{backgroundColor:G}},ie=K(_),ne={...J(N,L),...I&&{color:I},...P&&{backgroundColor:P}},re=K(N),le={...J(D,M),...$&&{color:$},...j&&{backgroundColor:j}},ae=K(D),se=le.fontSize,ge=a(g,{},a(d,{title:p("Display Settings"),initialOpen:!0},a(v,{label:p("Show Title"),checked:!1!==x,onChange:e=>t({showTitle:e})}),!1!==x&&a(h,{label:p("Override Title (optional)"),value:z||"",onChange:e=>t({overrideTitle:e}),placeholder:p("Enter custom title to override business name"),help:p("Leave empty to use business name from settings")}),a(v,{label:p("Show Rating Text"),checked:!1!==b,onChange:e=>t({showRatingText:e})}),!1!==b&&a(v,{label:p("Show Rating Text Below Stars"),checked:!0===f,onChange:e=>t({ratingTextBelow:e}),help:p("Display the rating text on a new line below the stars instead of inline")}),!1!==b&&a(h,{label:p("Custom Rating Text (optional)"),value:T||"",onChange:e=>t({customRatingText:e}),placeholder:p("e.g., Based on $review_count customer reviews"),help:p('Use $review_count where you want the review count to appear. HTML allowed: <p>, <a>, <br>, <strong>, <em>. Leave empty for default "(X reviews)" format.')}),a(v,{label:p("Show Google Link"),checked:o,onChange:e=>t({showLink:e})}),o&&a(h,{label:p("Override URL (optional)"),value:C||"",onChange:e=>t({overrideUrl:e}),placeholder:p("Enter custom URL to override Google Reviews URL"),help:p("Leave empty to use Google-provided URL")}),a(v,{label:p("Show Individual Reviews"),checked:i,onChange:e=>t({showReviewContent:e})}),i&&a(S,{label:p("Max Reviews to Show (Google API limit: 5)"),value:n,onChange:e=>t({maxReviews:e}),min:1,max:5}),i&&a(m,{label:p("Sort Reviews By"),value:w||"most_relevant",options:[{label:"Most Relevant",value:"most_relevant"},{label:"Most Recent",value:"newest"}],onChange:e=>t({reviewsSort:e})}))),ue=a(g,{group:"styles"},a(d,{title:p("Typography"),initialOpen:!1},a("h4",{style:{marginBottom:"10px"}},p("Title Font Size")),a(u,{__next40pxDefaultSize:!0,fontSizes:X,value:k||(y?X.find(e=>e.slug===y)?.size:void 0),onChange:e=>{const o=X.find(t=>t.size===e);o?t({titleFontSize:o.slug,titleFontSizeCustom:void 0}):"number"==typeof e?t({titleFontSize:"",titleFontSizeCustom:e}):void 0===e&&t({titleFontSize:"",titleFontSizeCustom:void 0})}}),a("h4",{style:{marginTop:"20px",marginBottom:"10px"}},p("Rating Text Font Size")),a(u,{__next40pxDefaultSize:!0,fontSizes:X,value:R||(F?X.find(e=>e.slug===F)?.size:void 0),onChange:e=>{const o=X.find(t=>t.size===e);o?t({ratingTextFontSize:o.slug,ratingTextFontSizeCustom:void 0}):"number"==typeof e?t({ratingTextFontSize:"",ratingTextFontSizeCustom:e}):void 0===e&&t({ratingTextFontSize:"",ratingTextFontSizeCustom:void 0})}}),a("h4",{style:{marginTop:"20px",marginBottom:"10px"}},p("Reviews Font Size")),a(u,{__next40pxDefaultSize:!0,fontSizes:X,value:B||(_?X.find(e=>e.slug===_)?.size:void 0),onChange:e=>{const o=X.find(t=>t.size===e);o?t({reviewsFontSize:o.slug,reviewsFontSizeCustom:void 0}):"number"==typeof e?t({reviewsFontSize:"",reviewsFontSizeCustom:e}):void 0===e&&t({reviewsFontSize:"",reviewsFontSizeCustom:void 0})}}),a("h4",{style:{marginTop:"20px",marginBottom:"10px"}},p("Review Time Font Size")),a(u,{__next40pxDefaultSize:!0,fontSizes:X,value:L||(N?X.find(e=>e.slug===N)?.size:void 0),onChange:e=>{const o=X.find(t=>t.size===e);o?t({reviewTimeFontSize:o.slug,reviewTimeFontSizeCustom:void 0}):"number"==typeof e?t({reviewTimeFontSize:"",reviewTimeFontSizeCustom:e}):void 0===e&&t({reviewTimeFontSize:"",reviewTimeFontSizeCustom:void 0})}}),a("h4",{style:{marginTop:"20px",marginBottom:"10px"}},p("Stars Font Size")),a(u,{__next40pxDefaultSize:!0,fontSizes:X,value:M||(D?X.find(e=>e.slug===D)?.size:void 0),onChange:e=>{const o=X.find(t=>t.size===e);o?t({starsFontSize:o.slug,starsFontSizeCustom:void 0}):"number"==typeof e?t({starsFontSize:"",starsFontSizeCustom:e}):void 0===e&&t({starsFontSize:"",starsFontSizeCustom:void 0})}})),a(d,{title:p("Colors"),initialOpen:!1},a(c,{title:p("Color Settings"),initialOpen:!1,colorSettings:[{value:l,onChange:e=>t({backgroundColor:e}),label:p("Block Background Color")},{value:s,onChange:e=>t({textColor:e}),label:p("Default Text Color")}]}),a(c,{title:p("Title Colors"),initialOpen:!1,colorSettings:[{value:E,onChange:e=>t({titleTextColor:e}),label:p("Title Text Color")},{value:O,onChange:e=>t({titleBackgroundColor:e}),label:p("Title Background Color")}]}),a(c,{title:p("Rating Colors"),initialOpen:!1,colorSettings:[{value:H,onChange:e=>t({ratingTextColor:e}),label:p("Rating Text Color")},{value:U,onChange:e=>t({ratingBackgroundColor:e}),label:p("Rating Background Color")}]}),a(c,{title:p("Reviews Colors"),initialOpen:!1,colorSettings:[{value:A,onChange:e=>t({reviewsTextColor:e}),label:p("Reviews Text Color")},{value:G,onChange:e=>t({reviewsBackgroundColor:e}),label:p("Reviews Background Color")}]}),a(c,{title:p("Review Time Colors"),initialOpen:!1,colorSettings:[{value:I,onChange:e=>t({reviewTimeTextColor:e}),label:p("Review Time Text Color")},{value:P,onChange:e=>t({reviewTimeBackgroundColor:e}),label:p("Review Time Background Color")}]}),a(c,{title:p("Stars Colors"),initialOpen:!1,colorSettings:[{value:$,onChange:e=>t({starsTextColor:e}),label:p("Stars Color")},{value:j,onChange:e=>t({starsBackgroundColor:e}),label:p("Stars Background Color")}]})));return q?[ge,ue,a("div",{className:"google-reviews-block loading",style:{backgroundColor:l,color:s}},p("Loading Google Reviews..."))]:Y?[ge,ue,a("div",{className:"google-reviews-block error",style:{backgroundColor:l,color:s,textAlign:r}},a("p",{},p("Error: ")+Y),a("p",{},p("Please check your settings in Settings → Google Reviews")))]:[ge,ue,a("div",{className:"google-reviews-block",style:{backgroundColor:l,color:s}},!1!==x?a("div",{className:"review-header"},a("h3",{className:V,style:Q,dangerouslySetInnerHTML:{__html:this.sanitizeHtml(z||W.name)}})):null,a("div",{className:"review-rating",style:te},a("span",{className:"rating-number"},W.rating.toFixed(1)),a("span",{className:"stars "+ae,style:le},this.renderStars(W.rating,$,se)),!1===b||f?null:T?a("span",{className:"rating-count "+ee,style:Z,dangerouslySetInnerHTML:{__html:this.sanitizeHtml(T.replace("$review_count",W.total_ratings))}}):a("span",{className:"rating-count "+ee,style:Z},"("+W.total_ratings+" reviews)")),!1!==b&&f?T?a("div",{className:"rating-count-below "+ee,style:Z,dangerouslySetInnerHTML:{__html:this.sanitizeHtml(T.replace("$review_count",W.total_ratings))}}):a("div",{className:"rating-count-below "+ee,style:Z},"("+W.total_ratings+" reviews)"):null,i&&W&&W.reviews&&W.reviews.length>0?a("div",{className:"reviews-container"},a("div",{className:"reviews-sort-info"},a("small",{},"Sorted by: "+("newest"===w?"Most Recent":"Most Relevant"))),a("div",{className:"individual-reviews "+ie,style:oe},W.reviews.slice(0,n).map((e,t)=>a("div",{key:t,className:"review-item"},a("div",{className:"review-header"},a("div",{className:"reviewer-info"},e.profile_photo_url?a("img",{src:e.profile_photo_url,alt:e.author_name,className:"reviewer-photo"}):null,a("div",{className:"reviewer-details"},a("span",{className:"reviewer-name",style:oe},e.author_name),a("div",{className:"review-rating-individual"},a("div",{className:"stars "+ae,style:le},this.renderStars(e.rating,$,se)),a("span",{className:"review-time "+re,style:ne},this.formatReviewTime(e.time)))))),e.text?a("div",{className:"review-text",style:oe,dangerouslySetInnerHTML:{__html:e.text.replace(/\n/g,"<br />")}}):null)))):null,o&&(C||W&&W.url)?a("div",{className:"review-link"},a("a",{href:C||W.url,target:"_blank",rel:"noopener"},p("See All Reviews on Google"))):null)]}sanitizeHtml(e){const t=document.createElement("div");t.innerHTML=e;t.querySelectorAll("script, style, iframe, object, embed").forEach(e=>e.remove());return t.querySelectorAll("*").forEach(e=>{for(let t of e.attributes)t.name.startsWith("on")&&e.removeAttribute(t.name)}),t.innerHTML}formatReviewTime(e){const t=new Date(1e3*e),o=new Date,i=Math.floor((o-t)/864e5);return i<7?0===i?"Today":1===i?"Yesterday":i+" days ago":t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}l("eightyfourem/google-reviews",{edit:z,save:function(){return null}}),l("google-reviews/display",{edit:z,save:function(){return null}})}(window.wp.blocks,window.wp.element,window.wp.blockEditor||window.wp.editor,window.wp.components,window.wp.i18n,window.wp.data);
//# sourceMappingURL=index.min.js.map
